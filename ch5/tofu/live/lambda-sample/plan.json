{"format_version":"1.2","terraform_version":"1.9.0","planned_values":{"outputs":{"function_url":{"sensitive":false}},"root_module":{"child_modules":[{"resources":[{"address":"module.function.aws_iam_role.lambda","mode":"managed","type":"aws_iam_role","name":"lambda","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"lambda-sample","path":"/","permissions_boundary":null,"tags":null},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}},{"address":"module.function.aws_iam_role_policy.allow_logging","mode":"managed","type":"aws_iam_role_policy","name":"allow_logging","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"name":"lambda-sample-allow-logging","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:PutLogEvents\",\"logs:CreateLogStream\",\"logs:CreateLogGroup\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:*:*:*\"}]}","role":"lambda-sample"},"sensitive_values":{}},{"address":"module.function.aws_lambda_function.function","mode":"managed","type":"aws_lambda_function","name":"function","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"NODE_ENV":"production"}}],"file_system_config":[],"filename":"../../../../ch3/tofu/modules/lambda/lambda-sample.zip","function_name":"lambda-sample","handler":"index.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"runtime":"nodejs20.x","s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"source_code_hash":"2RFjf2NdVR4XTOtJQ5aX3u01U/mzvphvVQPX1BzKNKM=","tags":null,"timeout":5,"timeouts":null,"vpc_config":[]},"sensitive_values":{"architectures":[],"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":[],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags_all":{},"tracing_config":[],"vpc_config":[]}},{"address":"module.function.aws_lambda_function_url.url[0]","mode":"managed","type":"aws_lambda_function_url","name":"url","index":0,"provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"authorization_type":"NONE","cors":[],"function_name":"lambda-sample","invoke_mode":"BUFFERED","qualifier":null,"timeouts":null},"sensitive_values":{"cors":[]}}],"address":"module.function"}]}},"resource_changes":[{"address":"module.function.aws_iam_role.lambda","module_address":"module.function","mode":"managed","type":"aws_iam_role","name":"lambda","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"lambda-sample","path":"/","permissions_boundary":null,"tags":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":true,"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}}},{"address":"module.function.aws_iam_role_policy.allow_logging","module_address":"module.function","mode":"managed","type":"aws_iam_role_policy","name":"allow_logging","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"lambda-sample-allow-logging","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:PutLogEvents\",\"logs:CreateLogStream\",\"logs:CreateLogGroup\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:*:*:*\"}]}","role":"lambda-sample"},"after_unknown":{"id":true,"name_prefix":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.function.aws_lambda_function.function","module_address":"module.function","mode":"managed","type":"aws_lambda_function","name":"function","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"NODE_ENV":"production"}}],"file_system_config":[],"filename":"../../../../ch3/tofu/modules/lambda/lambda-sample.zip","function_name":"lambda-sample","handler":"index.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"runtime":"nodejs20.x","s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"source_code_hash":"2RFjf2NdVR4XTOtJQ5aX3u01U/mzvphvVQPX1BzKNKM=","tags":null,"timeout":5,"timeouts":null,"vpc_config":[]},"after_unknown":{"architectures":true,"arn":true,"code_sha256":true,"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":true,"file_system_config":[],"id":true,"image_config":[],"invoke_arn":true,"last_modified":true,"logging_config":true,"qualified_arn":true,"qualified_invoke_arn":true,"role":true,"signing_job_arn":true,"signing_profile_version_arn":true,"snap_start":[],"source_code_size":true,"tags_all":true,"tracing_config":true,"version":true,"vpc_config":[]},"before_sensitive":false,"after_sensitive":{"architectures":[],"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":[],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags_all":{},"tracing_config":[],"vpc_config":[]}}},{"address":"module.function.aws_lambda_function_url.url[0]","module_address":"module.function","mode":"managed","type":"aws_lambda_function_url","name":"url","index":0,"provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"authorization_type":"NONE","cors":[],"function_name":"lambda-sample","invoke_mode":"BUFFERED","qualifier":null,"timeouts":null},"after_unknown":{"cors":[],"function_arn":true,"function_url":true,"id":true,"url_id":true},"before_sensitive":false,"after_sensitive":{"cors":[]}}}],"output_changes":{"function_url":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.9.0","values":{"root_module":{"child_modules":[{"resources":[{"address":"module.function.data.archive_file.source_code","mode":"data","type":"archive_file","name":"source_code","provider_name":"registry.opentofu.org/hashicorp/archive","schema_version":0,"values":{"exclude_symlink_directories":null,"excludes":null,"id":"726b0e7d3c57d5fea2e1c8f347f289e48faa387c","output_base64sha256":"2RFjf2NdVR4XTOtJQ5aX3u01U/mzvphvVQPX1BzKNKM=","output_base64sha512":"ALrl7deWIw7cA297rW33Xy841AOB3n7sXXFqDEV7Ys04dGDBKCztUC5ZgtypWyH1lCvjsE/U6OvqFcYzSkmhuw==","output_file_mode":null,"output_md5":"e0d0ceadd41e9d3e7b230c58da670b52","output_path":"../../../../ch3/tofu/modules/lambda/lambda-sample.zip","output_sha":"726b0e7d3c57d5fea2e1c8f347f289e48faa387c","output_sha256":"d911637f635d551e174ceb49439697deed3553f9b3be986f5503d7d41cca34a3","output_sha512":"00bae5edd796230edc036f7bad6df75f2f38d40381de7eec5d716a0c457b62cd387460c1282ced502e5982dca95b21f5942be3b04fd4e8ebea15c6334a49a1bb","output_size":240,"source":[],"source_content":null,"source_content_filename":null,"source_dir":"./src","source_file":null,"type":"zip"},"sensitive_values":{"source":[]}},{"address":"module.function.data.aws_iam_policy_document.allow_logging","mode":"data","type":"aws_iam_policy_document","name":"allow_logging","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"id":"16712114","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\"\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"logs:PutLogEvents\",\"logs:CreateLogStream\",\"logs:CreateLogGroup\"],\"Resource\":\"arn:aws:logs:*:*:*\"}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["arn:aws:logs:*:*:*"],"sid":""}],"version":"2012-10-17"},"sensitive_values":{"statement":[{"actions":[false,false,false],"condition":[],"not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":[false]}]}},{"address":"module.function.data.aws_iam_policy_document.policy","mode":"data","type":"aws_iam_policy_document","name":"policy","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"id":"2690255455","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRole\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["lambda.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_values":{"statement":[{"actions":[false],"condition":[],"not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":[false]}],"resources":[]}]}}],"address":"module.function"}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.opentofu.org/hashicorp/aws","expressions":{"region":{"constant_value":"us-east-2"}}},"module.function:archive":{"name":"archive","full_name":"registry.opentofu.org/hashicorp/archive","version_constraint":"~\u003e 2.0","module_address":"module.function"}},"root_module":{"outputs":{"function_url":{"expression":{"references":["module.function.function_url","module.function"]},"description":"The URL of the Lambda function"}},"module_calls":{"function":{"source":"../../../../ch3/tofu/modules/lambda","expressions":{"create_url":{"constant_value":true},"environment_variables":{"constant_value":{"NODE_ENV":"production"}},"handler":{"constant_value":"index.handler"},"memory_size":{"constant_value":128},"name":{"constant_value":"lambda-sample"},"runtime":{"constant_value":"nodejs20.x"},"src_dir":{"references":["path.module"]},"timeout":{"constant_value":5}},"module":{"outputs":{"function_arn":{"expression":{"references":["aws_lambda_function.function.arn","aws_lambda_function.function"]},"description":"The ARN of the Lambda function"},"function_name":{"expression":{"references":["aws_lambda_function.function.function_name","aws_lambda_function.function"]},"description":"The name of the Lambda function"},"function_url":{"expression":{"references":["aws_lambda_function_url.url","aws_lambda_function_url.url[0].function_url","aws_lambda_function_url.url[0]","aws_lambda_function_url.url"]},"description":"The Lambda function URL (if enabled)"},"function_version":{"expression":{"references":["aws_lambda_function.function.version","aws_lambda_function.function"]},"description":"The version of the Lambda function"},"iam_role_arn":{"expression":{"references":["aws_iam_role.lambda.arn","aws_iam_role.lambda"]},"description":"The ARN of the IAM role attached to the Lambda function"},"iam_role_name":{"expression":{"references":["aws_iam_role.lambda.name","aws_iam_role.lambda"]},"description":"The name of the IAM role attached to the Lambda function"}},"resources":[{"address":"aws_iam_role.lambda","mode":"managed","type":"aws_iam_role","name":"lambda","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.policy.json","data.aws_iam_policy_document.policy"]},"name":{"references":["var.name"]}},"schema_version":0},{"address":"aws_iam_role_policy.allow_logging","mode":"managed","type":"aws_iam_role_policy","name":"allow_logging","provider_config_key":"aws","expressions":{"name":{"references":["var.name"]},"policy":{"references":["data.aws_iam_policy_document.allow_logging.json","data.aws_iam_policy_document.allow_logging"]},"role":{"references":["aws_iam_role.lambda.name","aws_iam_role.lambda"]}},"schema_version":0},{"address":"aws_lambda_function.function","mode":"managed","type":"aws_lambda_function","name":"function","provider_config_key":"aws","expressions":{"environment":[{"variables":{"references":["var.environment_variables"]}}],"filename":{"references":["data.archive_file.source_code.output_path","data.archive_file.source_code"]},"function_name":{"references":["var.name"]},"handler":{"references":["var.handler"]},"memory_size":{"references":["var.memory_size"]},"package_type":{"constant_value":"Zip"},"role":{"references":["aws_iam_role.lambda.arn","aws_iam_role.lambda"]},"runtime":{"references":["var.runtime"]},"source_code_hash":{"references":["data.archive_file.source_code.output_base64sha256","data.archive_file.source_code"]},"timeout":{"references":["var.timeout"]}},"schema_version":0},{"address":"aws_lambda_function_url.url","mode":"managed","type":"aws_lambda_function_url","name":"url","provider_config_key":"aws","expressions":{"authorization_type":{"constant_value":"NONE"},"function_name":{"references":["aws_lambda_function.function.function_name","aws_lambda_function.function"]}},"schema_version":0,"count_expression":{"references":["var.create_url"]}},{"address":"data.archive_file.source_code","mode":"data","type":"archive_file","name":"source_code","provider_config_key":"module.function:archive","expressions":{"output_path":{"references":["path.module","var.name"]},"source_dir":{"references":["var.src_dir"]},"type":{"constant_value":"zip"}},"schema_version":0},{"address":"data.aws_iam_policy_document.allow_logging","mode":"data","type":"aws_iam_policy_document","name":"allow_logging","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"]},"effect":{"constant_value":"Allow"},"resources":{"constant_value":["arn:aws:logs:*:*:*"]}}]},"schema_version":0},{"address":"data.aws_iam_policy_document.policy","mode":"data","type":"aws_iam_policy_document","name":"policy","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"principals":[{"identifiers":{"constant_value":["lambda.amazonaws.com"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0}],"variables":{"create_url":{"default":false,"description":"If set to true, expose this function via a Lambda function URL."},"environment_variables":{"default":{},"description":"The environment variables to set for the Lambda function."},"handler":{"description":"The handler (entrypoint) for your Lambda function."},"memory_size":{"description":"The amount of memory, in MB, to give the Lambda function. See https://docs.aws.amazon.com/lambda/latest/operatorguide/computing-power.html for supported configurations."},"name":{"description":"The base name for the Lambda function and all other resources"},"runtime":{"description":"The Lambda runtime to use. See https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html#runtimes-supported for supported runtimes."},"src_dir":{"description":"The directory where your Lambda source code lives. This will be zipped up into a deployment package."},"timeout":{"description":"The timeout, in seconds, for the Lambda function. Max is 15 minutes (900 seconds)."}}}}}}},"relevant_attributes":[{"resource":"module.function.aws_iam_role.lambda","attribute":["arn"]},{"resource":"module.function.aws_iam_role.lambda","attribute":["name"]},{"resource":"module.function.aws_lambda_function.function","attribute":["arn"]},{"resource":"module.function.aws_lambda_function.function","attribute":["version"]},{"resource":"module.function.aws_lambda_function.function","attribute":["function_name"]},{"resource":"module.function.aws_lambda_function_url.url","attribute":[]},{"resource":"module.function.aws_lambda_function_url.url[0]","attribute":["function_url"]},{"resource":"module.function.data.archive_file.source_code","attribute":["output_path"]},{"resource":"module.function.data.archive_file.source_code","attribute":["output_base64sha256"]},{"resource":"module.function.data.aws_iam_policy_document.allow_logging","attribute":["json"]},{"resource":"module.function.data.aws_iam_policy_document.policy","attribute":["json"]}],"timestamp":"2025-04-24T02:41:39Z","errored":false}
